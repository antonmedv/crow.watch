{{ define "base" }}
  <!doctype html>
  <html lang="en">
    <head>
      <meta charset="utf-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1" />
      <title>{{ template "title" . }}</title>
      <link rel="icon" type="image/png" href="/favicon.png" />
      <link
        rel="icon"
        type="image/png"
        href="/static/favicon-96x96.png"
        sizes="96x96"
      />
      <link
        rel="apple-touch-icon"
        sizes="180x180"
        href="/static/apple-touch-icon.png"
      />
      <link rel="preconnect" href="https://fonts.googleapis.com" />
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
      <link
        rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Google+Sans:ital,wght@0,400;0,600;0,700;1,400&display=swap"
      />
      <link rel="stylesheet" href="{{ static "css/base.css" }}" />
      <link rel="stylesheet" href="{{ static "css/components.css" }}" />
      {{ block "head" . }}{{ end }}
      <script>
        ;(function () {
          var t = localStorage.getItem("theme")
          if (t) document.documentElement.setAttribute("data-theme", t)
        })()
      </script>
    </head>
    <body>
      <svg xmlns="http://www.w3.org/2000/svg" hidden style="display: none">
        <symbol id="icon-upvote" fill="currentColor" viewBox="0 0 256 256">
          <path
            d="M236.78,211.81A24.34,24.34,0,0,1,215.45,224H40.55a24.34,24.34,0,0,1-21.33-12.19,23.51,23.51,0,0,1,0-23.72L106.65,36.22a24.76,24.76,0,0,1,42.7,0L236.8,188.09A23.51,23.51,0,0,1,236.78,211.81Z"
          />
        </symbol>
        <symbol id="icon-theme" fill="currentColor" viewBox="0 0 256 256">
          <path d="M8 9a3 3 0 1 1 -3 3l.005 -.176a3 3 0 0 1 2.995 -2.824" />
          <path
            d="M248,160a8,8,0,0,1-8,8H16a8,8,0,0,1,0-16H56.45a73.54,73.54,0,0,1-.45-8,72,72,0,0,1,144,0,73.54,73.54,0,0,1-.45,8H240A8,8,0,0,1,248,160Zm-40,32H48a8,8,0,0,0,0,16H208a8,8,0,0,0,0-16ZM80.84,59.58a8,8,0,0,0,14.32-7.16l-8-16a8,8,0,0,0-14.32,7.16ZM20.42,103.16l16,8a8,8,0,1,0,7.16-14.31l-16-8a8,8,0,1,0-7.16,14.31ZM216,112a8,8,0,0,0,3.57-.84l16-8a8,8,0,1,0-7.16-14.31l-16,8A8,8,0,0,0,216,112ZM164.42,63.16a8,8,0,0,0,10.74-3.58l8-16a8,8,0,0,0-14.32-7.16l-8,16A8,8,0,0,0,164.42,63.16Z"
          />
        </symbol>
        <symbol id="icon-crow" fill="currentColor" viewBox="0 0 32 32">
          <path
            d="M23 5C24.6102 5.00002 24.5 5 27 6C30 6.5 31 7.5 31.5 8.5C29.5 9 27.5 8.5 26 10C25 12 26 13 25.5 15C24.5952 18.6191 22 21 19 22C18.7704 22.5729 18.5002 23.4992 18.5 23.5L20.5 25.5C23 25 23.5 26 24 27C21.0014 25.5007 19.5014 26.9986 19.5 27V26L17 23.5V23H15L14.5 24C14.5 24 15 24.5 16 26C19.1978 25.6984 19.0001 27.9993 19 28C15.5 26.5 15.5 27 13 27.5C12.5002 26.5004 14.4985 26.0004 14.5 26L13 24V23C11.5 23 11.4752 22.9536 10.5 23C3.50001 25.5 0.642919 26.2723 0.5 25.5C1 25 8 20 8 20C8 20 2.5 22 2.5 21C2.5 20 11.7521 13.3813 17.5 9C19.5 5 21.5 4.99998 23 5ZM24 6C23.4477 6 23 6.44772 23 7C23 7.55228 23.4477 8 24 8C24.5523 8 25 7.55228 25 7C25 6.44772 24.5523 6 24 6Z"
          />
          <path
            d="M23 5C24.6102 5.00002 24.5 5 27 6C30 6.5 31 7.5 31.5 8.5C29.5 9 27.5 8.5 26 10C25 12 26 13 25.5 15C24.5952 18.6191 22 21 19 22C18.7704 22.5729 18.5002 23.4992 18.5 23.5L20.5 25.5C22.5 25 24.5 25.5 25 27C22 25.5 19.5 27 19.5 27V26L17 24V23H15L14.5 24C14.5 24 15 24.5 16 26C18 26.5 18.5 26.5 19 28C15.5 26.5 15.5 27 13 27.5C12.5002 26.5004 14.4985 26.0004 14.5 26L13 24V23C11.5 23 11.4752 22.9536 10.5 23C3.50001 25.5 0.642919 26.2723 0.5 25.5C1 25 8 20 8 20C8 20 2.5 22 2.5 21C2.5 20 11.7521 13.3813 17.5 9C19.5 5 21.5 4.99998 23 5ZM24 6C23.4477 6 23 6.44772 23 7C23 7.55228 23.4477 8 24 8C24.5523 8 25 7.55228 25 7C25 6.44772 24.5523 6 24 6Z"
          />
        </symbol>
        <symbol
          id="icon-article"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="1.5"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
          <path
            d="M3 6a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2l0 -12"
          />
          <path d="M7 8h10" />
          <path d="M7 12h10" />
          <path d="M7 16h10" />
        </symbol>
      </svg>
      <div class="site-container">
        <nav class="site-nav">
          <a href="/" class="nav-logo" aria-label="Crow Watch">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="36"
              height="36"
              fill="none"
              viewBox="0 0 543 543"
            >
              <path
                fill="currentColor"
                d="M543 543h-94c-25.167-20-75.9-78.4-75.5-150 .5-89.5 51-54.596 102.5-53.5 20 .426 27.5-2 27.5-2 16.5-34.5-14-99-45-120.5C390.5 23 150 52.5 0 266.5V0h543z"
              />
              <path
                fill="#fff"
                d="M0 266.5C150 52.5 390.5 23 458.5 217c31 21.5 61.5 86 45 120.5-.009.003-7.513 2.425-27.5 2-51.5-1.096-102-36-102.5 53.5-.4 71.6 50.333 130 75.5 150H0v-.001h394C356.5 485 355 440.501 352 411c-.051.102-10.51 21.041-14.5 37.5 0-20.499.882-45.629 8.5-73.501 7.927-28.999 19-56.68 38-57.999 36-2.5 61.5 4.001 102 3.001 4.5-60.5-71.5-133.001-119.5-106.501-4 .5-11 0-13.5-1.5 13.5-16.5 39-30.5 79-9C332 5.5 149.5 147.001 71.5 253.501c0 0 19.5-10.501 41.5-17.001-.144.139-67.05 64.6-113 157.499zm305-22c33 1 146 45 170.5 67.5-64.5-25.5-89-30.5-147-54-10.056-4.075-14.278-7.783-23.5-13.5M265.5 171c19-1 36.5 9 41 25.5-3 15-12.425 22.321-26 22.5-14.382.19-26.762-10.136-27.5-24.5-.533-10.381 3.738-17.908 12.5-23.5"
              />
              <path
                fill="#242323"
                d="M71.5 253.501C149.5 147 332 5.5 432 203c-40-21.5-65.5-7.5-79 9 2.5 1.5 9.5 2 13.5 1.5 48-26.5 124 46 119.5 106.501-40.5.999-66-5.501-102-3.001-19 1.319-30.073 29-38 57.999-7.618 27.872-8.5 53.002-8.5 73.501 4-16.499 14.5-37.5 14.5-37.5 3 29.5 4.5 74 42 131.999H0v-149c46-93 113-157.499 113-157.499-22 6.5-41.5 17.001-41.5 17.001M305 244.5c9.223 5.716 13.444 9.425 23.5 13.5 58 23.5 82.5 28.5 147 54C451 289.499 338 245.499 305 244.5m1.5-48c-4.5-16.5-22-26.5-41-25.5-8.763 5.591-13.033 13.119-12.5 23.5.737 14.364 13.118 24.689 27.5 24.5 13.575-.18 23-7.5 26-22.5"
              />
              <circle cx="286" cy="187" r="16" fill="#242424" />
            </svg>
          </a>
          <div class="nav-content">
            <div class="nav-top">
              <span class="nav-slogan">
                {{ if .IsLoggedIn }}
                  {{ .Slogan }}
                {{ else }}
                  a computing-focused community
                {{ end }}
              </span>
              <div class="nav-actions">
                <span class="theme-picker">
                  <button
                    class="theme-picker__toggle"
                    title="Theme"
                    aria-label="Change theme"
                    aria-expanded="false"
                  >
                    <svg width="20" height="20">
                      <use href="#icon-theme"></use>
                    </svg>
                  </button>
                  <div class="theme-picker__popup" hidden>
                    <button class="theme-picker__option" data-theme-set="auto">
                      Auto
                    </button>
                    <button class="theme-picker__option" data-theme-set="light">
                      Light
                    </button>
                    <button class="theme-picker__option" data-theme-set="dark">
                      Dark
                    </button>
                    <button class="theme-picker__option" data-theme-set="black">
                      Black
                    </button>
                    <button class="theme-picker__option" data-theme-set="green">
                      Green
                    </button>
                    <button
                      class="theme-picker__option"
                      data-theme-set="orange"
                    >
                      Orange
                    </button>
                  </div>
                </span>
                {{ if .IsLoggedIn }}
                  <a href="/account">{{ .Username }}</a>
                {{ else }}
                  <a href="/login">Login</a>
                {{ end }}
              </div>
            </div>
            <div class="nav-bottom">
              <div class="nav-links">
                <a href="/">Home</a>
                <a href="/newest">Newest</a>
                <a href="/t/show">Show</a>
                {{ if .IsLoggedIn }}
                  <a href="/replies">
                    Replies
                    {{- if .UnreadReplies }}
                      <span class="nav-badge">{{ .UnreadReplies }}</span>
                    {{- end }}
                  </a>
                {{ end }}
              </div>
              {{ if .IsLoggedIn }}
                <div class="nav-links">
                  {{ if .IsModerator }}
                    <a href="/mod/campaigns">Campaigns</a>
                  {{ end }}
                  <a href="/invite">Invite</a>
                  <a href="/submit">Submit</a>
                </div>
              {{ end }}
            </div>
          </div>
        </nav>
        <main>{{ block "content" . }}{{ end }}</main>
        <footer class="site-footer">
          <svg class="site-footer__icon" width="20" height="20">
            <use href="#icon-crow"></use>
          </svg>
          <div class="site-footer__links">
            <a href="/about">About</a>
            <a href="/tags">Tags</a>
            <a href="/mod/log">Mod Log</a>
          </div>
        </footer>
      </div>
      {{ if .IsLoggedIn }}
        <script src="{{ static "js/vote.js" }}"></script>
        <script src="{{ static "js/hide-tag.js" }}"></script>
        <script src="{{ static "js/comment.js" }}"></script>
        <script src="{{ static "js/flag.js" }}"></script>
      {{ end }}
      <script>
        ;(function () {
          const toggle = document.querySelector(".theme-picker__toggle")
          const popup = document.querySelector(".theme-picker__popup")
          const cur = localStorage.getItem("theme") || "auto"
          popup
            .querySelectorAll(".theme-picker__option")
            .forEach(function (btn) {
              if (btn.dataset.themeSet === cur)
                btn.classList.add("theme-picker__option--active")
            })
          toggle.addEventListener("click", function (e) {
            e.stopPropagation()
            var open = !popup.hidden
            popup.hidden = open
            toggle.setAttribute("aria-expanded", !open)
          })
          document.addEventListener("click", function (e) {
            if (!e.target.closest(".theme-picker")) {
              popup.hidden = true
              toggle.setAttribute("aria-expanded", "false")
            }
          })
          popup.addEventListener("click", function (e) {
            var btn = e.target.closest(".theme-picker__option")
            if (!btn) return
            var val = btn.dataset.themeSet
            popup
              .querySelectorAll(".theme-picker__option")
              .forEach(function (b) {
                b.classList.remove("theme-picker__option--active")
              })
            btn.classList.add("theme-picker__option--active")
            if (val === "auto") {
              localStorage.removeItem("theme")
              document.documentElement.removeAttribute("data-theme")
            } else {
              localStorage.setItem("theme", val)
              document.documentElement.setAttribute("data-theme", val)
            }
          })
        })()
      </script>
      {{ if .DevMode }}
        <script src="{{ static "js/reload.js" }}"></script>
      {{ end }}
    </body>
  </html>
{{ end }}
